function PointNG(t){this.config=t,this.level=t.level,this.api_key=t.api_key,this.widgetPosition=t.widgetPosition,this.privacyPolicyLink=t.privacyPolicyLink}!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).brain=e()}(this,function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}var r=function(t){return t&&t.Math==Math&&t},i=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||Function("return this")(),o=function(t){try{return!!t()}catch(t){return!0}},a=!o(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),u={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,c={f:s&&!u.call({1:2},1)?function(t){var e=s(this,t);return!!e&&e.enumerable}:u},l=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},h={}.toString,p=function(t){return h.call(t).slice(8,-1)},f="".split,y=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==p(t)?f.call(t,""):Object(t)}:Object,d=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},g=function(t){return y(d(t))},v=function(t){return"object"==typeof t?null!==t:"function"==typeof t},m=function(t,e){if(!v(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!v(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!v(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!v(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},b={}.hasOwnProperty,w=function(t,e){return b.call(t,e)},k=i.document,O=v(k)&&v(k.createElement),L=!a&&!o(function(){return 7!=Object.defineProperty((t="div",O?k.createElement(t):{}),"a",{get:function(){return 7}}).a;var t}),A=Object.getOwnPropertyDescriptor,T={f:a?A:function(t,e){if(t=g(t),e=m(e,!0),L)try{return A(t,e)}catch(t){}if(w(t,e))return l(!c.f.call(t,e),t[e])}},_=function(t){if(!v(t))throw TypeError(String(t)+" is not an object");return t},x=Object.defineProperty,E={f:a?x:function(t,e,n){if(_(t),e=m(e,!0),_(n),L)try{return x(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},S=a?function(t,e,n){return E.f(t,e,l(1,n))}:function(t,e,n){return t[e]=n,t},I=function(t,e){try{S(i,t,e)}catch(n){i[t]=e}return e},P=i["__core-js_shared__"]||I("__core-js_shared__",{}),j=Function.toString;"function"!=typeof P.inspectSource&&(P.inspectSource=function(t){return j.call(t)});var M,R,z,D=P.inspectSource,C=i.WeakMap,F="function"==typeof C&&/native code/.test(D(C)),B=n(function(t){(t.exports=function(t,e){return P[t]||(P[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})}),N=0,$=Math.random(),U=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++N+$).toString(36)},J=B("keys"),V=function(t){return J[t]||(J[t]=U(t))},H={},W=i.WeakMap;if(F){var q=new W,G=q.get,Y=q.has,K=q.set;M=function(t,e){return K.call(q,t,e),e},R=function(t){return G.call(q,t)||{}},z=function(t){return Y.call(q,t)}}else{var X=V("state");H[X]=!0,M=function(t,e){return S(t,X,e),e},R=function(t){return w(t,X)?t[X]:{}},z=function(t){return w(t,X)}}var Q,Z,tt={set:M,get:R,has:z,enforce:function(t){return z(t)?R(t):M(t,{})},getterFor:function(t){return function(e){var n;if(!v(e)||(n=R(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},et=n(function(t){var e=tt.get,n=tt.enforce,r=String(String).split("String");(t.exports=function(t,e,o,a){var u=!!a&&!!a.unsafe,s=!!a&&!!a.enumerable,c=!!a&&!!a.noTargetGet;"function"==typeof o&&("string"!=typeof e||w(o,"name")||S(o,"name",e),n(o).source=r.join("string"==typeof e?e:"")),t!==i?(u?!c&&t[e]&&(s=!0):delete t[e],s?t[e]=o:S(t,e,o)):s?t[e]=o:I(e,o)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||D(this)})}),nt=i,rt=function(t){return"function"==typeof t?t:void 0},it=function(t,e){return arguments.length<2?rt(nt[t])||rt(i[t]):nt[t]&&nt[t][e]||i[t]&&i[t][e]},ot=Math.ceil,at=Math.floor,ut=function(t){return isNaN(t=+t)?0:(t>0?at:ot)(t)},st=Math.min,ct=function(t){return t>0?st(ut(t),9007199254740991):0},lt=Math.max,ht=Math.min,pt=function(t,e){var n=ut(t);return n<0?lt(n+e,0):ht(n,e)},ft=function(t){return function(e,n,r){var i,o=g(e),a=ct(o.length),u=pt(r,a);if(t&&n!=n){for(;a>u;)if((i=o[u++])!=i)return!0}else for(;a>u;u++)if((t||u in o)&&o[u]===n)return t||u||0;return!t&&-1}},yt={includes:ft(!0),indexOf:ft(!1)},dt=yt.indexOf,gt=function(t,e){var n,r=g(t),i=0,o=[];for(n in r)!w(H,n)&&w(r,n)&&o.push(n);for(;e.length>i;)w(r,n=e[i++])&&(~dt(o,n)||o.push(n));return o},vt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],mt=vt.concat("length","prototype"),bt={f:Object.getOwnPropertyNames||function(t){return gt(t,mt)}},wt=/#|\.prototype\./,kt=function(t,e){var n=Lt[Ot(t)];return n==Tt||n!=At&&("function"==typeof e?o(e):!!e)},Ot=kt.normalize=function(t){return String(t).replace(wt,".").toLowerCase()},Lt=kt.data={},At=kt.NATIVE="N",Tt=kt.POLYFILL="P",_t=kt,xt=T.f,Et=function(t,e){var n,r,o,a,u,s=t.target,c=t.global,l=t.stat;if(n=c?i:l?i[s]||I(s,{}):(i[s]||{}).prototype)for(r in e){if(a=e[r],o=t.noTargetGet?(u=xt(n,r))&&u.value:n[r],!_t(c?r:s+(l?".":"#")+r,t.forced)&&void 0!==o){if(typeof a==typeof o)continue;copyConstructorProperties(a,o)}(t.sham||o&&o.sham)&&S(a,"sham",!0),et(n,r,a,t)}},St=Array.isArray||function(t){return"Array"==p(t)},It=function(t){return Object(d(t))},Pt=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())}),jt=Pt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Mt=B("wks"),Rt=i.Symbol,zt=jt?Rt:Rt&&Rt.withoutSetter||U,Dt=function(t){return w(Mt,t)||(Pt&&w(Rt,t)?Mt[t]=Rt[t]:Mt[t]=zt("Symbol."+t)),Mt[t]},Ct=Dt("species"),Ft=function(t,e){var n;return St(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!St(n.prototype)?v(n)&&null===(n=n[Ct])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)},Bt=it("navigator","userAgent")||"",Nt=i.process,$t=Nt&&Nt.versions,Ut=$t&&$t.v8;Ut?Z=(Q=Ut.split("."))[0]+Q[1]:Bt&&(!(Q=Bt.match(/Edge\/(\d+)/))||Q[1]>=74)&&(Q=Bt.match(/Chrome\/(\d+)/))&&(Z=Q[1]);var Jt=Z&&+Z,Vt=Dt("species"),Ht=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},Wt=[].push,qt=function(t){var e=1==t,n=2==t,r=3==t,i=4==t,o=6==t,a=5==t||o;return function(u,s,c,l){for(var h,p,f=It(u),d=y(f),g=function(t,e,n){if(Ht(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}(s,c,3),v=ct(d.length),m=0,b=l||Ft,w=e?b(u,v):n?b(u,0):void 0;v>m;m++)if((a||m in d)&&(p=g(h=d[m],m,f),t))if(e)w[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:Wt.call(w,h)}else if(i)return!1;return o?-1:r||i?i:w}},Gt={forEach:qt(0),map:qt(1),filter:qt(2),some:qt(3),every:qt(4),find:qt(5),findIndex:qt(6)},Yt=function(t,e){var n=[][t];return!!n&&o(function(){n.call(null,e||function(){throw 1},1)})},Kt=Object.defineProperty,Xt={},Qt=function(t){throw t},Zt=function(t,e){if(w(Xt,t))return Xt[t];e||(e={});var n=[][t],r=!!w(e,"ACCESSORS")&&e.ACCESSORS,i=w(e,0)?e[0]:Qt,u=w(e,1)?e[1]:void 0;return Xt[t]=!!n&&!o(function(){if(r&&!a)return!0;var t={length:-1};r?Kt(t,1,{enumerable:!0,get:Qt}):t[1]=1,n.call(t,i,u)})},te=Gt.forEach,ee=Yt("forEach"),ne=Zt("forEach"),re=ee&&ne?[].forEach:function(t){return te(this,t,arguments.length>1?arguments[1]:void 0)};Et({target:"Array",proto:!0,forced:[].forEach!=re},{forEach:re});var ie=function(t){return function(e,n,r,i){Ht(n);var o=It(e),a=y(o),u=ct(o.length),s=t?u-1:0,c=t?-1:1;if(r<2)for(;;){if(s in a){i=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw TypeError("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(i=n(i,a[s],s,o));return i}},oe={left:ie(!1),right:ie(!0)},ae=Object.keys||function(t){return gt(t,vt)},ue=Object.assign,se=Object.defineProperty,ce=!ue||o(function(){if(a&&1!==ue({b:1},ue(se({},"a",{enumerable:!0,get:function(){se(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=ue({},t)[n]||"abcdefghijklmnopqrst"!=ae(ue({},e)).join("")})?function(t,e){for(var n=It(t),r=arguments.length,i=1,o=objectGetOwnPropertySymbols.f,u=c.f;r>i;)for(var s,l=y(arguments[i++]),h=o?ae(l).concat(o(l)):ae(l),p=h.length,f=0;p>f;)s=h[f++],a&&!u.call(l,s)||(n[s]=l[s]);return n}:ue;Et({target:"Object",stat:!0,forced:Object.assign!==ce},{assign:ce});var le=o(function(){ae(1)});Et({target:"Object",stat:!0,forced:le},{keys:function(t){return ae(It(t))}});for(var he in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var pe=i[he],fe=pe&&pe.prototype;if(fe&&fe.forEach!==re)try{S(fe,"forEach",re)}catch(t){fe.forEach=re}}function ye(t){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ve(t,e,n){return e&&ge(t.prototype,e),n&&ge(t,n),t}function me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function be(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function we(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?be(Object(n),!0).forEach(function(e){me(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}Et({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var ke,Oe=function(t){for(var e=It(this),n=ct(e.length),r=arguments.length,i=pt(r>1?arguments[1]:void 0,n),o=r>2?arguments[2]:void 0,a=void 0===o?n:pt(o,n);a>i;)e[i++]=t;return e},Le=a?Object.defineProperties:function(t,e){_(t);for(var n,r=ae(e),i=r.length,o=0;i>o;)E.f(t,n=r[o++],e[n]);return t},Ae=(it("document","documentElement"),V("IE_PROTO")),Te=function(){},_e=function(){try{ke=document.domain&&new ActiveXObject("htmlfile")}catch(t){}_e=ke?function(t){t.write("<script><\/script>"),t.close();var e=t.parentWindow.Object;return t=null,e}(ke):NullProtoObjectViaIFrame();for(var t=vt.length;t--;)delete _e.prototype[vt[t]];return _e()};H[Ae]=!0;var xe=Object.create||function(t,e){var n;return null!==t?(Te.prototype=_(t),n=new Te,Te.prototype=null,n[Ae]=t):n=_e(),void 0===e?n:Le(n,e)},Ee=Dt("unscopables"),Se=Array.prototype;null==Se[Ee]&&E.f(Se,Ee,{configurable:!0,value:xe(null)});var Ie=function(t){Se[Ee][t]=!0};Et({target:"Array",proto:!0},{fill:Oe}),Ie("fill");var Pe,je,Me,Re={},ze=!o(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),De=V("IE_PROTO"),Ce=Object.prototype,Fe=ze?Object.getPrototypeOf:function(t){return t=It(t),w(t,De)?t[De]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Ce:null},Be=Dt("iterator"),Ne=!1;[].keys&&("next"in(Me=[].keys())?(je=Fe(Fe(Me)))!==Object.prototype&&(Pe=je):Ne=!0),null==Pe&&(Pe={}),w(Pe,Be)||S(Pe,Be,function(){return this});var $e={IteratorPrototype:Pe,BUGGY_SAFARI_ITERATORS:Ne},Ue=E.f,Je=Dt("toStringTag"),Ve=function(t,e,n){t&&!w(t=n?t:t.prototype,Je)&&Ue(t,Je,{configurable:!0,value:e})},He=$e.IteratorPrototype,We=function(){return this},qe=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return _(n),function(t){if(!v(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(r),e?t.call(n,r):n.__proto__=r,n}}():void 0),Ge=$e.IteratorPrototype,Ye=$e.BUGGY_SAFARI_ITERATORS,Ke=Dt("iterator"),Xe=function(){return this},Qe=tt.set,Ze=tt.getterFor("Array Iterator"),tn=function(t,e,n,r,i,o,a){!function(t,e,n){var r=e+" Iterator";t.prototype=xe(He,{next:l(1,n)}),Ve(t,r,!1),Re[r]=We}(n,e,r);var u,s,c,h=function(t){if(t===i&&g)return g;if(!Ye&&t in y)return y[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},p=e+" Iterator",f=!1,y=t.prototype,d=y[Ke]||y["@@iterator"]||i&&y[i],g=!Ye&&d||h(i),v="Array"==e&&y.entries||d;if(v&&(u=Fe(v.call(new t)),Ge!==Object.prototype&&u.next&&(Fe(u)!==Ge&&(qe?qe(u,Ge):"function"!=typeof u[Ke]&&S(u,Ke,Xe)),Ve(u,p,!0))),"values"==i&&d&&"values"!==d.name&&(f=!0,g=function(){return d.call(this)}),y[Ke]!==g&&S(y,Ke,g),Re[e]=g,i)if(s={values:h("values"),keys:o?g:h("keys"),entries:h("entries")},a)for(c in s)!Ye&&!f&&c in y||et(y,c,s[c]);else Et({target:e,proto:!0,forced:Ye||f},s);return s}(Array,"Array",function(t,e){Qe(this,{type:"Array Iterator",target:g(t),index:0,kind:e})},function(){var t=Ze(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}},"values");Re.Arguments=Re.Array,Ie("keys"),Ie("values"),Ie("entries");var en,nn=Gt.map,rn=(en="map",Jt>=51||!o(function(){var t=[];return(t.constructor={})[Vt]=function(){return{foo:1}},1!==t[en](Boolean).foo})),on=Zt("map");Et({target:"Array",proto:!0,forced:!rn||!on},{map:function(t){return nn(this,t,arguments.length>1?arguments[1]:void 0)}});var an="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,un=function(t,e,n){for(var r in e)et(t,r,e[r],n);return t},sn=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t},cn=function(t){if(void 0===t)return 0;var e=ut(t),n=ct(e);if(e!==n)throw RangeError("Wrong length or index");return n},ln=(Math.abs,Math.pow,Math.floor,Math.log,Math.LN2,E.f,tt.get),hn=tt.set,pn=i.ArrayBuffer,fn=i.DataView,yn=fn&&fn.prototype,dn=Object.prototype,gn=i.RangeError;if(!an){pn=function(t){sn(this,pn,"ArrayBuffer");var e=cn(t);hn(this,{bytes:Oe.call(new Array(e),0),byteLength:e}),a||(this.byteLength=e)},fn=function(t,e,n){sn(this,fn,"DataView"),sn(t,pn,"DataView");var r=ln(t).byteLength,i=ut(e);if(i<0||i>r)throw gn("Wrong offset");if(i+(n=void 0===n?r-i:ct(n))>r)throw gn("Wrong length");hn(this,{buffer:t,byteLength:n,byteOffset:i}),a||(this.buffer=t,this.byteLength=n,this.byteOffset=i)},qe&&Fe(yn)!==dn&&qe(yn,dn);var vn=new fn(new pn(2)),mn=yn.setInt8;vn.setInt8(0,2147483648),vn.setInt8(1,2147483649),!vn.getInt8(0)&&vn.getInt8(1)||un(yn,{setInt8:function(t,e){mn.call(this,t,e<<24>>24)},setUint8:function(t,e){mn.call(this,t,e<<24>>24)}},{unsafe:!0})}Ve(pn,"ArrayBuffer"),Ve(fn,"DataView");var bn={ArrayBuffer:pn,DataView:fn},wn=Dt("species"),kn=function(t,e){var n,r=_(t).constructor;return void 0===r||null==(n=_(r)[wn])?e:Ht(n)},On=bn.ArrayBuffer,Ln=bn.DataView,An=On.prototype.slice,Tn=o(function(){return!new On(2).slice(1,void 0).byteLength});Et({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:Tn},{slice:function(t,e){if(void 0!==An&&void 0===e)return An.call(_(this),t);for(var n=_(this).byteLength,r=pt(t,n),i=pt(void 0===e?n:e,n),o=new(kn(this,On))(ct(i-r)),a=new Ln(this),u=new Ln(o),s=0;r<i;)u.setUint8(s++,a.getUint8(r++));return o}});var _n={};_n[Dt("toStringTag")]="z";var xn="[object z]"===String(_n),En=Dt("toStringTag"),Sn="Arguments"==p(function(){return arguments}()),In=xn?p:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),En))?n:Sn?p(e):"Object"==(r=p(e))&&"function"==typeof e.callee?"Arguments":r},Pn=xn?{}.toString:function(){return"[object "+In(this)+"]"};xn||et(Object.prototype,"toString",Pn,{unsafe:!0});var jn=Dt("iterator"),Mn=!1;try{var Rn=0,zn={next:function(){return{done:!!Rn++}},return:function(){Mn=!0}};zn[jn]=function(){return this},Array.from(zn,function(){throw 2})}catch(t){}var Dn,Cn=function(t,e){if(!e&&!Mn)return!1;var n=!1;try{var r={};r[jn]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},Fn=(E.f,i.Int8Array),Bn=Fn&&Fn.prototype,Nn=i.Uint8ClampedArray,$n=(Nn&&Nn.prototype,Fn&&Fe(Fn)),Un=Bn&&Fe(Bn),Jn=Object.prototype.isPrototypeOf,Vn=(Dt("toStringTag"),U("TYPED_ARRAY_TAG"),an&&!!qe&&"Opera"!==In(i.opera)),Hn={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Wn=function(t){return v(t)&&w(Hn,In(t))};for(Dn in Hn)i[Dn]||(Vn=!1);if((!Vn||"function"!=typeof $n||$n===Function.prototype)&&($n=function(){throw TypeError("Incorrect invocation")},Vn))for(Dn in Hn)i[Dn]&&qe(i[Dn],$n);var qn={NATIVE_ARRAY_BUFFER_VIEWS:Vn,TYPED_ARRAY_TAG:!1,aTypedArray:function(t){if(Wn(t))return t;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(t){if(qe){if(Jn.call($n,t))return t}else for(var e in Hn)if(w(Hn,Dn)){var n=i[e];if(n&&(t===n||Jn.call(n,t)))return t}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n){if(a){if(n)for(var r in Hn){var o=i[r];o&&w(o.prototype,t)&&delete o.prototype[t]}Un[t]&&!n||et(Un,t,n?e:Vn&&Bn[t]||e)}},exportTypedArrayStaticMethod:function(t,e,n){var r,o;if(a){if(qe){if(n)for(r in Hn)(o=i[r])&&w(o,t)&&delete o[t];if($n[t]&&!n)return;try{return et($n,t,n?e:Vn&&Fn[t]||e)}catch(t){}}for(r in Hn)!(o=i[r])||o[t]&&!n||et(o,t,e)}},isView:function(t){var e=In(t);return"DataView"===e||w(Hn,e)},isTypedArray:Wn,TypedArray:$n,TypedArrayPrototype:Un},Gn=qn.NATIVE_ARRAY_BUFFER_VIEWS,Yn=i.ArrayBuffer,Kn=i.Int8Array,Xn=!Gn||!o(function(){Kn(1)})||!o(function(){new Kn(-1)})||!Cn(function(t){new Kn,new Kn(null),new Kn(1.5),new Kn(t)},!0)||o(function(){return 1!==new Kn(new Yn(2),1,void 0).length}),Qn=Dt("species"),Zn=function(t){var e=it(t),n=E.f;a&&e&&!e[Qn]&&n(e,Qn,{configurable:!0,get:function(){return this}})};n(function(t){var e=bt.f,n=Gt.forEach,r=tt.get,o=tt.set,u=E.f,s=T.f,c=Math.round,h=i.RangeError,p=bn.ArrayBuffer,f=bn.DataView,y=qn.NATIVE_ARRAY_BUFFER_VIEWS,d=qn.TYPED_ARRAY_TAG,g=qn.TypedArray,b=qn.TypedArrayPrototype,k=qn.aTypedArrayConstructor,O=qn.isTypedArray,L=function(t,e){for(var n=0,r=e.length,i=new(k(t))(r);r>n;)i[n]=e[n++];return i},A=function(t,e){u(t,e,{get:function(){return r(this)[e]}})},_=function(t){var e;return t instanceof p||"ArrayBuffer"==(e=In(t))||"SharedArrayBuffer"==e},x=function(t,e){return O(t)&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},I=function(t,e){return x(t,e=m(e,!0))?l(2,t[e]):s(t,e)},P=function(t,e,n){return!(x(t,e=m(e,!0))&&v(n)&&w(n,"value"))||w(n,"get")||w(n,"set")||n.configurable||w(n,"writable")&&!n.writable||w(n,"enumerable")&&!n.enumerable?u(t,e,n):(t[e]=n.value,t)};a?(y||(T.f=I,E.f=P,A(b,"buffer"),A(b,"byteOffset"),A(b,"byteLength"),A(b,"length")),Et({target:"Object",stat:!0,forced:!y},{getOwnPropertyDescriptor:I,defineProperty:P}),t.exports=function(t,a,s){var l=t.match(/\d+$/)[0]/8,m=t+(s?"Clamped":"")+"Array",w="get"+t,k="set"+t,A=i[m],T=A,x=T&&T.prototype,E={},I=function(t,e){u(t,e,{get:function(){return function(t,e){var n=r(t);return n.view[w](e*l+n.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,n){var i=r(t);s&&(n=(n=c(n))<0?0:n>255?255:255&n),i.view[k](e*l+i.byteOffset,n,!0)}(this,e,t)},enumerable:!0})};y?Xn&&(T=a(function(t,e,n,r){return sn(t,T,m),inheritIfRequired(v(e)?_(e)?void 0!==r?new A(e,toOffset(n,l),r):void 0!==n?new A(e,toOffset(n,l)):new A(e):O(e)?L(T,e):typedArrayFrom.call(T,e):new A(cn(e)),t,T)}),qe&&qe(T,g),n(e(A),function(t){t in T||S(T,t,A[t])}),T.prototype=x):(T=a(function(t,e,n,r){sn(t,T,m);var i,a,u,s=0,c=0;if(v(e)){if(!_(e))return O(e)?L(T,e):typedArrayFrom.call(T,e);i=e,c=toOffset(n,l);var y=e.byteLength;if(void 0===r){if(y%l)throw h("Wrong length");if((a=y-c)<0)throw h("Wrong length")}else if((a=ct(r)*l)+c>y)throw h("Wrong length");u=a/l}else u=cn(e),i=new p(a=u*l);for(o(t,{buffer:i,byteOffset:c,byteLength:a,length:u,view:new f(i)});s<u;)I(t,s++)}),qe&&qe(T,g),x=T.prototype=xe(b)),x.constructor!==T&&S(x,"constructor",T),d&&S(x,d,m),E[m]=T,Et({global:!0,forced:T!=A,sham:!y},E),"BYTES_PER_ELEMENT"in T||S(T,"BYTES_PER_ELEMENT",l),"BYTES_PER_ELEMENT"in x||S(x,"BYTES_PER_ELEMENT",l),Zn(m)}):t.exports=function(){}})("Float32",function(t){return function(e,n,r){return t(this,e,n,r)}});var tr=Math.min,er=[].copyWithin||function(t,e){var n=It(this),r=ct(n.length),i=pt(t,r),o=pt(e,r),a=arguments.length>2?arguments[2]:void 0,u=tr((void 0===a?r:pt(a,r))-o,r-i),s=1;for(o<i&&i<o+u&&(s=-1,o+=u-1,i+=u-1);u-- >0;)o in n?n[i]=n[o]:delete n[i],i+=s,o+=s;return n},nr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("copyWithin",function(t,e){return er.call(nr(this),t,e,arguments.length>2?arguments[2]:void 0)});var rr=Gt.every,ir=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("every",function(t){return rr(ir(this),t,arguments.length>1?arguments[1]:void 0)});var or=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("fill",function(t){return Oe.apply(or(this),arguments)});var ar=Gt.filter,ur=qn.aTypedArray,sr=qn.aTypedArrayConstructor;(0,qn.exportTypedArrayMethod)("filter",function(t){for(var e=ar(ur(this),t,arguments.length>1?arguments[1]:void 0),n=kn(this,this.constructor),r=0,i=e.length,o=new(sr(n))(i);i>r;)o[r]=e[r++];return o});var cr=Gt.find,lr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("find",function(t){return cr(lr(this),t,arguments.length>1?arguments[1]:void 0)});var hr=Gt.findIndex,pr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("findIndex",function(t){return hr(pr(this),t,arguments.length>1?arguments[1]:void 0)});var fr=Gt.forEach,yr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("forEach",function(t){fr(yr(this),t,arguments.length>1?arguments[1]:void 0)});var dr=yt.includes,gr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("includes",function(t){return dr(gr(this),t,arguments.length>1?arguments[1]:void 0)});var vr=yt.indexOf,mr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("indexOf",function(t){return vr(mr(this),t,arguments.length>1?arguments[1]:void 0)});var br=Dt("iterator"),wr=i.Uint8Array,kr=tn.values,Or=tn.keys,Lr=tn.entries,Ar=qn.aTypedArray,Tr=qn.exportTypedArrayMethod,_r=wr&&wr.prototype[br],xr=!!_r&&("values"==_r.name||null==_r.name),Er=function(){return kr.call(Ar(this))};Tr("entries",function(){return Lr.call(Ar(this))}),Tr("keys",function(){return Or.call(Ar(this))}),Tr("values",Er,!xr),Tr(br,Er,!xr);var Sr=qn.aTypedArray,Ir=[].join;(0,qn.exportTypedArrayMethod)("join",function(t){return Ir.apply(Sr(this),arguments)});var Pr=Math.min,jr=[].lastIndexOf,Mr=!!jr&&1/[1].lastIndexOf(1,-0)<0,Rr=Yt("lastIndexOf"),zr=Zt("indexOf",{ACCESSORS:!0,1:0}),Dr=Mr||!Rr||!zr?function(t){if(Mr)return jr.apply(this,arguments)||0;var e=g(this),n=ct(e.length),r=n-1;for(arguments.length>1&&(r=Pr(r,ut(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}:jr,Cr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("lastIndexOf",function(t){return Dr.apply(Cr(this),arguments)});var Fr=Gt.map,Br=qn.aTypedArray,Nr=qn.aTypedArrayConstructor;(0,qn.exportTypedArrayMethod)("map",function(t){return Fr(Br(this),t,arguments.length>1?arguments[1]:void 0,function(t,e){return new(Nr(kn(t,t.constructor)))(e)})});var $r=oe.left,Ur=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("reduce",function(t){return $r(Ur(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)});var Jr=oe.right,Vr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("reduceRight",function(t){return Jr(Vr(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)});var Hr=qn.aTypedArray,Wr=qn.exportTypedArrayMethod,qr=Math.floor;Wr("reverse",function(){for(var t,e=Hr(this).length,n=qr(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this});var Gr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("set",function(t){Gr(this);var e=toOffset(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=It(t),i=ct(r.length),o=0;if(i+e>n)throw RangeError("Wrong length");for(;o<i;)this[e+o]=r[o++]},o(function(){new Int8Array(1).set({})}));var Yr=qn.aTypedArray,Kr=qn.aTypedArrayConstructor,Xr=[].slice;(0,qn.exportTypedArrayMethod)("slice",function(t,e){for(var n=Xr.call(Yr(this),t,e),r=kn(this,this.constructor),i=0,o=n.length,a=new(Kr(r))(o);o>i;)a[i]=n[i++];return a},o(function(){new Int8Array(1).slice()}));var Qr=Gt.some,Zr=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("some",function(t){return Qr(Zr(this),t,arguments.length>1?arguments[1]:void 0)});var ti=qn.aTypedArray,ei=[].sort;(0,qn.exportTypedArrayMethod)("sort",function(t){return ei.call(ti(this),t)});var ni=qn.aTypedArray;(0,qn.exportTypedArrayMethod)("subarray",function(t,e){var n=ni(this),r=n.length,i=pt(t,r);return new(kn(n,n.constructor))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,ct((void 0===e?r:pt(e,r))-i))});var ri=i.Int8Array,ii=qn.aTypedArray,oi=qn.exportTypedArrayMethod,ai=[].toLocaleString,ui=[].slice,si=!!ri&&o(function(){ai.call(new ri(1))});oi("toLocaleString",function(){return ai.apply(si?ui.call(ii(this)):ii(this),arguments)},o(function(){return[1,2].toLocaleString()!=new ri([1,2]).toLocaleString()})||!o(function(){ri.prototype.toLocaleString.call([1,2])}));var ci=qn.exportTypedArrayMethod,li=i.Uint8Array,hi=li&&li.prototype||{},pi=[].toString,fi=[].join;o(function(){pi.call({})})&&(pi=function(){return fi.call(this)});var yi=hi.toString!=pi;ci("toString",pi,yi);var di=function(t){return new Float32Array(t)},gi=function(t,e){var n=new Float32Array(t);if(e)for(var r=0;r<t;r++)n[r]=randomFloat$1(-e,e);else for(var i=0;i<t;i++)n[i]=.4*Math.random()-.2;return n},vi=function(){function t(){de(this,t)}return ve(t,null,[{key:"toTable",value:function(e){var n=e.reduce(function(t,e){return Object.assign(t,e)},{});return t.toHash(n)}},{key:"toTable2D",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i=t[r],o=0;o<i.length;o++){var a=i[o];for(var u in a)a.hasOwnProperty(u)&&!e.hasOwnProperty(u)&&(e[u]=n++)}return e}},{key:"toInputTable",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i in t[r].input)e.hasOwnProperty(i)||(e[i]=n++);return e}},{key:"toInputTable2D",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i=t[r].input,o=0;o<i.length;o++){var a=i[o];for(var u in a)e.hasOwnProperty(u)||(e[u]=n++)}return e}},{key:"toOutputTable",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i in t[r].output)e.hasOwnProperty(i)||(e[i]=n++);return e}},{key:"toOutputTable2D",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i=t[r].output,o=0;o<i.length;o++){var a=i[o];for(var u in a)e.hasOwnProperty(u)||(e[u]=n++)}return e}},{key:"toHash",value:function(t){var e={},n=0;for(var r in t)e[r]=n++;return e}},{key:"toArray",value:function(t,e,n){var r=new Float32Array(n);for(var i in t)r[t[i]]=e.hasOwnProperty(i)?e[i]:0;return r}},{key:"toArrayShort",value:function(t,e){var n=[];for(var r in t){if(!e.hasOwnProperty(r))break;n[t[r]]=e[r]}return Float32Array.from(n)}},{key:"toArrays",value:function(t,e,n){for(var r=[],i=0;i<e.length;i++)r.push(this.toArray(t,e[i],n));return r}},{key:"toObject",value:function(t,e){var n={};for(var r in t)n[r]=e[t[r]];return n}},{key:"toObjectPartial",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i={},o=0;for(var a in t)n>0&&o++<n||r>0&&o++>=r||(i[a]=e[t[a]-n]);return i}},{key:"lookupFromArray",value:function(t){for(var e={},n=0,r=t.length;r-- >0;)e[t[r]]=n++;return e}},{key:"dataShape",value:function(t){var e,n=[];for(t.input?(n.push("datum"),t=t.input):Array.isArray(t)&&(t[0].input?(n.push("array","datum"),t=t[0].input):(n.push("array"),t=t[0]));t;){for(e in t)break;if(!t.hasOwnProperty(e))break;if(Array.isArray(t)||t.buffer instanceof ArrayBuffer)n.push("array"),t=t[e];else{if("object"!==ye(t))throw new Error("unhandled signature");n.push("object"),t=t[e]}}return n.push(ye(t)),n}},{key:"addKeys",value:function(t,e){if(!Array.isArray(t)){e=e||{};var n=Object.keys(e).length;for(var r in t)t.hasOwnProperty(r)&&(e.hasOwnProperty(r)||(e[r]=n++));return e}}}]),t}(),mi={FeedForward:function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};de(this,t),this.layers=null,this.inputLayer=null,this.hiddenLayers=null,this.outputLayer=null,this.praxisOpts=null,this.praxis=null,Object.assign(this,this.constructor.defaults,e),this.trainOpts={},this._updateTrainingOptions(we(we({},this.constructor.trainDefaults),e)),Object.assign(this,this.constructor.structure),this._inputLayer=null,this._hiddenLayers=null,this._outputLayer=null}return ve(t,[{key:"_setLogMethod",value:function(t){this.trainOpts.log="function"==typeof t?t:!!t&&console.log}},{key:"_updateTrainingOptions",value:function(t){var e=this;Object.keys(this.constructor.trainDefaults).forEach(function(n){e.trainOpts[n]=t.hasOwnProperty(n)?t[n]:e.trainOpts[n]}),this.constructor._validateTrainingOptions(this.trainOpts),this._setLogMethod(t.log||this.trainOpts.log),this.trainOpts.callback&&this.trainOpts.callbackPeriod!==this.trainOpts.errorCheckInterval&&console.warn("options.callbackPeriod with value of ".concat(this.trainOpts.callbackPeriod," does not match options.errorCheckInterval with value of ").concat(this.trainOpts.errorCheckInterval,", if logging error, it will repeat.  These values may need to match"))}}],[{key:"_validateTrainingOptions",value:function(e){var n={iterations:function(t){return"number"==typeof t&&t>0},errorThresh:function(t){return"number"==typeof t&&t>0&&t<1},log:function(t){return"function"==typeof t||"boolean"==typeof t},logPeriod:function(t){return"number"==typeof t&&t>0},learningRate:function(t){return"number"==typeof t&&t>0&&t<1},callback:function(t){return"function"==typeof t||null===t},callbackPeriod:function(t){return"number"==typeof t&&t>0},timeout:function(t){return"number"==typeof t&&t>0}};Object.keys(t.trainDefaults).forEach(function(t){if(n.hasOwnProperty(t)&&!n[t](e[t]))throw new Error("[".concat(t,", ").concat(e[t],"] is out of normal training range, your network will probably not train."))})}},{key:"trainDefaults",get:function(){return{iterations:2e4,errorThresh:.005,log:!1,logPeriod:10,learningRate:.3,callback:null,callbackPeriod:10,errorCheckInterval:100,reinforce:!1}}},{key:"defaults",get:function(){return{learningRate:.3,binaryThresh:.5,hiddenLayers:null,inputLayer:null,outputLayer:null,praxisOpts:null,praxis:function(t,e){return praxis.momentumRootMeanSquaredPropagation(we({},t),t.praxisOpts||e)}}}},{key:"structure",get:function(){return{layers:null,_inputLayer:null,_outputLayer:null,_model:null}}}]),ve(t,[{key:"_connectLayers",value:function(){var t=[];this._inputLayer=this.inputLayer();var e=this._connectHiddenLayers(this._inputLayer);this._outputLayer=this.outputLayer(e[e.length-1],e.length),t.push(this._inputLayer),t.push.apply(t,_toConsumableArray(e)),t.push(this._outputLayer),this.layers=flattenLayers(t)}},{key:"_connectHiddenLayers",value:function(t){this._hiddenLayers=[];for(var e=[],n=0;n<this.hiddenLayers.length;n++){var r=this.hiddenLayers[n](t,n);e.push(r),this._hiddenLayers.push(r),t=r}return e}},{key:"initialize",value:function(){this._connectLayers(),this.initializeLayers(this.layers),this._model=this.layers.filter(function(t){return t instanceof Model$4})}},{key:"initializeLayers",value:function(t){for(var e=0;e<t.length;e++){var n=t[e];n.setupKernels(!0),n instanceof Model$4&&n.hasOwnProperty("praxis")&&null===n.praxis&&(n.praxis=this.praxis(n,n.praxisOpts||this.praxisOpts),n.praxis.setupKernels())}var r=t[t.length-1];this.meanSquaredError=new MeanSquaredError$1({width:r.width,height:r.height})}},{key:"run",value:function(t){this.inputLookup&&(t=vi.toArray(this.inputLookup,t));var e=this.runInput(t);return e.toArray&&(e=e.toArray()),this.outputLookup&&(e=vi.toHash(this.outputLookup,e)),e}},{key:"runInput",value:function(t){this.layers[0].predict(t);for(var e=1;e<this.layers.length;e++)this.layers[e].predict();return this.layers[this.layers.length-1].weights}},{key:"train",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this._prepTraining(t,r);for(t=i.data,e=i.status,n=i.endTime;this._trainingTick(t,e,n););return e}},{key:"_trainingTick",value:function(t,e,n){return!(e.iterations>=this.trainOpts.iterations||e.error<=this.trainOpts.errorThresh||Date.now()>=n)&&(this.trainOpts.log&&e.iterations%this.trainOpts.logPeriod==0?(e.error=this._calculateTrainingError(t),this.trainOpts.log("iterations: ".concat(e.iterations,", training error: ").concat(e.error))):e.iterations%this.trainOpts.errorCheckInterval==0?e.error=this._calculateTrainingError(t):this._trainPatterns(t),this.trainOpts.callback&&e.iterations%this.trainOpts.callbackPeriod==0&&this.trainOpts.callback(Object.assign(e)),e.iterations++,!0)}},{key:"_prepTraining",value:function(t,e){this._updateTrainingOptions(e);var n=this.formatData(t),r=Date.now()+this.trainOpts.timeout;return this.verifyIsInitialized(),{data:this.transferData(n),status:{error:1,iterations:0},endTime:r}}},{key:"verifyIsInitialized",value:function(){this._model||this.initialize()}},{key:"_calculateTrainingError",value:function(t){for(var e=new Float32Array([0]),n=0;n<t.length;++n){var r=e,i=this._trainPattern(t[n].input,t[n].output,!0);e=this.meanSquaredError.add(e,i),release$h(i),release$h(r)}var o=this.meanSquaredError.divide(t.length,e);if(release$h(e),o.toArray){var a=o.toArray();return release$h(o),a[0]}return o[0]}},{key:"_trainPatterns",value:function(t){for(var e=0;e<t.length;++e)this._trainPattern(t[e].input,t[e].output,!1)}},{key:"_trainPattern",value:function(t,e,n){return this.runInput(t),this._calculateDeltas(e),this.adjustWeights(),n?this.meanSquaredError.calculate(this._outputLayer.errors):null}},{key:"_calculateDeltas",value:function(t){for(var e=this.layers.length-1;e>-1;e--)this.layers[e].compare(t)}},{key:"adjustWeights",value:function(){for(var t=this._model,e=0;e<t.length;e++)t[e].learn(null,null,this.trainOpts.learningRate)}},{key:"formatData",value:function(t){var e=this;if(!Array.isArray(t)){var n=[];n.push(t),t=n}var r=t[0].input;Array.isArray(r)||r instanceof Float32Array||(this.inputLookup||(this.inputLookup=vi.buildLookup(t.map(function(t){return t.input}))),t=t.map(function(t){var n=vi.toArray(e.inputLookup,t.input);return we(we({},t),{},{input:n})},this));var i=t[0].output;return Array.isArray(i)||i instanceof Float32Array||(this.outputLookup||(this.outputLookup=vi.buildLookup(t.map(function(t){return t.output}))),t=t.map(function(t){var n=vi.toArray(e.outputLookup,t.output);return we(we({},t),{},{output:n})},this)),t}},{key:"transferData",value:function(t){for(var e=new Array(t.length),n=makeKernel$l(function(t){return t[this.thread.x]},{output:[t[0].input.length],immutable:!0}),r=makeKernel$l(function(t){return t[this.thread.x]},{output:[t[0].output.length],immutable:!0}),i=0;i<t.length;i++){var o=t[i];e[i]={input:n(o.input),output:r(o.output)}}return e}},{key:"test",value:function(){throw new Error("".concat(this.constructor.name,"-test is not yet implemented"))}},{key:"toJSON",value:function(){this.layers||this.initialize();for(var t=[],e=0;e<this.layers.length;e++){var n=this.layers[e],r=n.toJSON();n.hasOwnProperty("inputLayer")?r.inputLayerIndex=this.layers.indexOf(n.inputLayer):n.hasOwnProperty("inputLayer1")&&n.hasOwnProperty("inputLayer2")&&(r.inputLayer1Index=this.layers.indexOf(n.inputLayer1),r.inputLayer2Index=this.layers.indexOf(n.inputLayer2)),t.push(r)}return{type:this.constructor.name,sizes:[this._inputLayer.height].concat(this._hiddenLayers.map(function(t){return t.height})).concat([this._outputLayer.height]),layers:t}}},{key:"toFunction",value:function(){throw new Error("".concat(this.constructor.name,"-toFunction is not yet implemented"))}},{key:"createTrainStream",value:function(){throw new Error("".concat(this.constructor.name,"-createTrainStream is not yet implemented"))}}],[{key:"fromJSON",value:function(e,n){var r=e.layers,i=[],o=layerFromJson(r[0])||n(r[0]);i.push(o);for(var a=1;a<r.length;a++){var u=r[a];if(u.hasOwnProperty("inputLayerIndex")){var s=i[u.inputLayerIndex];i.push(layerFromJson(u,s)||n(u,s))}else{if(!u.hasOwnProperty("inputLayer1Index"))throw new Error("Cannot create network from provided JOSN. inputLayer1Index not defined.");if(!u.hasOwnProperty("inputLayer2Index"))throw new Error("Cannot create network from provided JOSN. inputLayer2Index not defined.");var c=i[u.inputLayer1Index],l=i[u.inputLayer2Index];if(void 0===c)throw new Error("Cannot create network from provided JOSN. layer of index ".concat(u.inputLayer1Index," not found."));if(void 0===l)throw new Error("Cannot create network from provided JOSN. layer of index ".concat(u.inputLayer2Index," not found."));i.push(layerFromJson(u,o)||n(u,c,l))}}var h=new t(e);return h.layers=i,h}}]),t}()},bi=[].join,wi=y!=Object,ki=Yt("join",",");Et({target:"Array",proto:!0,forced:wi||!ki},{join:function(t){return bi.call(g(this),void 0===t?",":t)}});var Oi,Li,Ai,Ti,_i=i.Promise,xi=function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=Ht(e),this.reject=Ht(n)},Ei={f:function(t){return new xi(t)}},Si=function(t,e){if(_(t),v(e)&&e.constructor===t)return e;var n=Ei.f(t);return(0,n.resolve)(e),n.promise},Ii=Dt("species"),Pi="Promise",ji=tt.get,Mi=tt.set,Ri=tt.getterFor(Pi),zi=_i,Di=(i.document,i.process),Ci=it("fetch"),Fi=Ei.f,Bi=Fi,Ni="process"==p(Di),$i=_t(Pi,function(){if(!(D(zi)!==String(zi))){if(66===Jt)return!0;if(!Ni&&"function"!=typeof PromiseRejectionEvent)return!0}if(Jt>=51&&/native code/.test(zi))return!1;var t=zi.resolve(1),e=function(t){t(function(){},function(){})};return(t.constructor={})[Ii]=e,!(t.then(function(){})instanceof e)}),Ui=$i||!Cn(function(t){zi.all(t).catch(function(){})});$i&&(zi=function(t){sn(this,zi,Pi),Ht(t),Oi.call(this);var e=ji(this);try{t(bind(internalResolve,this,e),bind(internalReject,this,e))}catch(t){internalReject(this,e,t)}},(Oi=function(t){Mi(this,{type:Pi,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=un(zi.prototype,{then:function(t,e){var n=Ri(this),r=Fi(kn(this,zi));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=Ni?Di.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&notify$1(this,n,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),Li=function(){var t=new Oi,e=ji(t);this.promise=t,this.resolve=bind(internalResolve,t,e),this.reject=bind(internalReject,t,e)},Ei.f=Fi=function(t){return t===zi||t===Ai?new Li(t):Bi(t)},"function"==typeof _i&&(Ti=_i.prototype.then,et(_i.prototype,"then",function(t,e){var n=this;return new zi(function(t,e){Ti.call(n,t,e)}).then(t,e)},{unsafe:!0}),"function"==typeof Ci&&Et({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return Si(zi,Ci.apply(i,arguments))}}))),Et({global:!0,wrap:!0,forced:$i},{Promise:zi}),Ve(zi,Pi,!1),Zn(Pi),Ai=it(Pi),Et({target:Pi,stat:!0,forced:$i},{reject:function(t){var e=Fi(this);return e.reject.call(void 0,t),e.promise}}),Et({target:Pi,stat:!0,forced:$i},{resolve:function(t){return Si(this,t)}}),Et({target:Pi,stat:!0,forced:Ui},{all:function(t){var e=this,n=Fi(e),r=n.resolve,i=n.reject,o=perform(function(){var n=Ht(e.resolve),o=[],a=0,u=1;iterate_1(t,function(t){var s=a++,c=!1;o.push(void 0),u++,n.call(e,t).then(function(t){c||(c=!0,o[s]=t,--u||r(o))},i)}),--u||r(o)});return o.error&&i(o.value),n.promise},race:function(t){var e=this,n=Fi(e),r=n.reject,i=perform(function(){var i=Ht(e.resolve);iterate_1(t,function(t){i.call(e,t).then(n.resolve,r)})});return i.error&&r(i.value),n.promise}});var Ji=n(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.thaw=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new a(t,e)};var i=!1,o=[],a=function(){function t(e){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var u=n({},this.constructor.defaultSettings,a),s=u.each,c=u.done;this.items=e,this.i=0,this.options=a;var l=this.tick=function(){if(!(r.i<0||(r.timeout=setTimeout(l,0),i))){var t=e[r.i];if(r.i>=e.length)return null!==c&&(i=!0,c(t,r.i),i=!1),r.i=-1,void clearTimeout(r.timeout);null!==s?(i=!0,s(t,r.i),i=!1):void 0!==t&&t(),r.i++}};o.push(this),a.delay||l()}return r(t,null,[{key:"stopAll",value:function(){for(var t=0;t<o.length;t++)o[t].stop()}},{key:"defaultSettings",get:function(){return{each:null,done:null}}},{key:"isThawing",get:function(){return i}}]),r(t,[{key:"makeReady",value:function(){return this.i<0&&(this.i=this.items.length,!0)}},{key:"add",value:function(t){var e=this.makeReady();return this.items.push(t),e&&this.tick(),this}},{key:"insert",value:function(t){var e=this.makeReady();return this.items.splice(this.i,0,t),e&&this.tick(),this}},{key:"addArray",value:function(t){var e=this.makeReady();return this.items=this.items.concat(t),e&&this.tick(),this}},{key:"insertArray",value:function(t){var e=this.makeReady(),n=this.items,r=t,i=this.items.splice(this.i,this.items.length-this.i+1);return this.items=n.concat(r,i),e&&this.tick(),this}},{key:"stop",value:function(){return this.i=-1,clearTimeout(this.timeout),this.options.done&&this.options.done(),this}}]),t}();e.default=a});e(Ji);Ji.thaw;e(n(function(t,e){}));var Vi=n(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Block=void 0});e(Vi);Vi.Block,c.f;var Hi=function(t,e){for(var n=[];t<e;t++)n.push(t);return n},Wi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};de(this,t),Object.assign(this,this.constructor.defaults,e),this.trainOpts={},this.updateTrainingOptions(we(we({},this.constructor.trainDefaults),e)),this.sizes=null,this.outputLayer=null,this.biases=null,this.weights=null,this.outputs=null,this.deltas=null,this.changes=null,this.errors=null,this.errorCheckInterval=1,this.constructor.prototype.hasOwnProperty("runInput")||(this.runInput=null),this.constructor.prototype.hasOwnProperty("calculateDeltas")||(this.calculateDeltas=null),this.inputLookup=null,this.inputLookupLength=null,this.outputLookup=null,this.outputLookupLength=null,e.inputSize&&e.hiddenLayers&&e.outputSize&&(this.sizes=[e.inputSize].concat(e.hiddenLayers).concat([e.outputSize]))}return ve(t,null,[{key:"trainDefaults",get:function(){return{iterations:2e4,errorThresh:.005,log:!1,logPeriod:10,learningRate:.3,momentum:.1,callback:null,callbackPeriod:10,timeout:1/0,praxis:null,beta1:.9,beta2:.999,epsilon:1e-8}}},{key:"defaults",get:function(){return{leakyReluAlpha:.01,binaryThresh:.5,hiddenLayers:null,activation:"sigmoid"}}}]),ve(t,[{key:"initialize",value:function(){if(!this.sizes)throw new Error("Sizes must be set before initializing");this.outputLayer=this.sizes.length-1,this.biases=[],this.weights=[],this.outputs=[],this.deltas=[],this.changes=[],this.errors=[];for(var t=0;t<=this.outputLayer;t++){var e=this.sizes[t];if(this.deltas[t]=di(e),this.errors[t]=di(e),this.outputs[t]=di(e),t>0){this.biases[t]=gi(e),this.weights[t]=new Array(e),this.changes[t]=new Array(e);for(var n=0;n<e;n++){var r=this.sizes[t-1];this.weights[t][n]=gi(r),this.changes[t][n]=di(r)}}}this.setActivation(),"adam"===this.trainOpts.praxis&&this._setupAdam()}},{key:"setActivation",value:function(t){switch(this.activation=t||this.activation,this.activation){case"sigmoid":this.runInput=this.runInput||this._runInputSigmoid,this.calculateDeltas=this.calculateDeltas||this._calculateDeltasSigmoid;break;case"relu":this.runInput=this.runInput||this._runInputRelu,this.calculateDeltas=this.calculateDeltas||this._calculateDeltasRelu;break;case"leaky-relu":this.runInput=this.runInput||this._runInputLeakyRelu,this.calculateDeltas=this.calculateDeltas||this._calculateDeltasLeakyRelu;break;case"tanh":this.runInput=this.runInput||this._runInputTanh,this.calculateDeltas=this.calculateDeltas||this._calculateDeltasTanh;break;default:throw new Error("Unknown activation ".concat(this.activation,". Available activations are: 'sigmoid', 'relu', 'leaky-relu', 'tanh'"))}}},{key:"run",value:function(t){if(!this.isRunnable)return null;this.inputLookup&&(t=vi.toArray(this.inputLookup,t,this.inputLookupLength));var e=this.runInput(t).slice(0);return this.outputLookup&&(e=vi.toObject(this.outputLookup,e)),e}},{key:"_runInputSigmoid",value:function(t){this.outputs[0]=t;for(var e=null,n=1;n<=this.outputLayer;n++){for(var r=this.sizes[n],i=this.weights[n],o=this.biases[n],a=this.outputs[n],u=0;u<r;u++){for(var s=i[u],c=o[u],l=0;l<s.length;l++)c+=s[l]*t[l];a[u]=1/(1+Math.exp(-c))}e=t=this.outputs[n]}return e}},{key:"_runInputRelu",value:function(t){this.outputs[0]=t;for(var e=null,n=1;n<=this.outputLayer;n++){for(var r=this.sizes[n],i=this.weights[n],o=this.biases[n],a=this.outputs[n],u=0;u<r;u++){for(var s=i[u],c=o[u],l=0;l<s.length;l++)c+=s[l]*t[l];a[u]=c<0?0:c}e=t=a}return e}},{key:"_runInputLeakyRelu",value:function(t){this.outputs[0]=t;for(var e=this.leakyReluAlpha,n=null,r=1;r<=this.outputLayer;r++){for(var i=this.sizes[r],o=this.weights[r],a=this.biases[r],u=this.outputs[r],s=0;s<i;s++){for(var c=o[s],l=a[s],h=0;h<c.length;h++)l+=c[h]*t[h];u[s]=l<0?0:e*l}n=t=u}return n}},{key:"_runInputTanh",value:function(t){this.outputs[0]=t;for(var e=null,n=1;n<=this.outputLayer;n++){for(var r=this.sizes[n],i=this.weights[n],o=this.biases[n],a=this.outputs[n],u=0;u<r;u++){for(var s=i[u],c=o[u],l=0;l<s.length;l++)c+=s[l]*t[l];a[u]=Math.tanh(c)}e=t=a}return e}},{key:"verifyIsInitialized",value:function(t){var e=this;this.sizes||(this.sizes=[],this.sizes.push(t[0].input.length),this.hiddenLayers?this.hiddenLayers.forEach(function(t){e.sizes.push(t)}):this.sizes.push(Math.max(3,Math.floor(t[0].input.length/2))),this.sizes.push(t[0].output.length),this.initialize())}},{key:"updateTrainingOptions",value:function(t){var e=this.constructor.trainDefaults;for(var n in e)e.hasOwnProperty(n)&&(this.trainOpts[n]=t.hasOwnProperty(n)?t[n]:e[n]);this.validateTrainingOptions(this.trainOpts),this.setLogMethod(t.log||this.trainOpts.log),this.activation=t.activation||this.activation}},{key:"validateTrainingOptions",value:function(t){var e={iterations:function(t){return"number"==typeof t&&t>0},errorThresh:function(t){return"number"==typeof t&&t>0&&t<1},log:function(t){return"function"==typeof t||"boolean"==typeof t},logPeriod:function(t){return"number"==typeof t&&t>0},learningRate:function(t){return"number"==typeof t&&t>0&&t<1},momentum:function(t){return"number"==typeof t&&t>0&&t<1},callback:function(t){return"function"==typeof t||null===t},callbackPeriod:function(t){return"number"==typeof t&&t>0},timeout:function(t){return"number"==typeof t&&t>0}};for(var n in e)if(e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&!e[n](t[n]))throw new Error("[".concat(n,", ").concat(t[n],"] is out of normal training range, your network will probably not train."))}},{key:"getTrainOptsJSON",value:function(){var t=this;return Object.keys(this.constructor.trainDefaults).reduce(function(e,n){return"timeout"===n&&t.trainOpts[n]===1/0?e:"callback"===n?e:(t.trainOpts[n]&&(e[n]=t.trainOpts[n]),"log"===n&&(e.log="function"==typeof e.log),e)},{})}},{key:"setLogMethod",value:function(t){this.trainOpts.log="function"==typeof t?t:!!t&&this.logTrainingStatus}},{key:"logTrainingStatus",value:function(t){console.log("iterations: ".concat(t.iterations,", training error: ").concat(t.error))}},{key:"calculateTrainingError",value:function(t){for(var e=0,n=0;n<t.length;++n)e+=this.trainPattern(t[n],!0);return e/t.length}},{key:"trainPatterns",value:function(t){for(var e=0;e<t.length;++e)this.trainPattern(t[e])}},{key:"trainingTick",value:function(t,e,n){var r=this.trainOpts,i=r.callback,o=r.callbackPeriod,a=r.errorThresh,u=r.iterations,s=r.log,c=r.logPeriod;return!(e.iterations>=u||e.error<=a||Date.now()>=n)&&(e.iterations++,s&&e.iterations%c==0?(e.error=this.calculateTrainingError(t),s(e)):e.iterations%this.errorCheckInterval==0?e.error=this.calculateTrainingError(t):this.trainPatterns(t),i&&e.iterations%o==0&&i({iterations:e.iterations,error:e.error}),!0)}},{key:"prepTraining",value:function(t,e){this.updateTrainingOptions(e),t=this.formatData(t);var n=Date.now()+this.trainOpts.timeout;return this.verifyIsInitialized(t),{data:t,status:{error:1,iterations:0},endTime:n}}},{key:"train",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.prepTraining(t,r);for(t=i.data,e=i.status,n=i.endTime;this.trainingTick(t,e,n););return e}},{key:"trainAsync",value:function(t){var e,n,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.prepTraining(t,i);return t=o.data,e=o.status,n=o.endTime,new Promise(function(i,o){try{var a=new Thaw(new Array(r.trainOpts.iterations),{delay:!0,each:function(){return r.trainingTick(t,e,n)||a.stop()},done:function(){return i(e)}});a.tick()}catch(t){o(new Error({trainError:t,status:e}))}})}},{key:"trainPattern",value:function(t,e){return this.runInput(t.input),this.calculateDeltas(t.output),this.adjustWeights(),e?mse(this.errors[this.outputLayer]):null}},{key:"_calculateDeltasSigmoid",value:function(t){for(var e=this.outputLayer;e>=0;e--)for(var n=this.sizes[e],r=this.outputs[e],i=this.errors[e],o=this.deltas[e],a=this.weights[e+1],u=0;u<n;u++){var s=r[u],c=0;if(e===this.outputLayer)c=t[u]-s;else for(var l=this.deltas[e+1],h=0;h<l.length;h++)c+=l[h]*a[h][u];i[u]=c,o[u]=c*s*(1-s)}}},{key:"_calculateDeltasRelu",value:function(t){for(var e=this.outputLayer;e>=0;e--)for(var n=this.sizes[e],r=this.outputs[e],i=this.weights[e+1],o=this.deltas[e+1],a=this.errors[e],u=this.deltas[e],s=0;s<n;s++){var c=r[s],l=0;if(e===this.outputLayer)l=t[s]-c;else for(var h=0;h<o.length;h++)l+=o[h]*i[h][s];a[s]=l,u[s]=c>0?l:0}}},{key:"_calculateDeltasLeakyRelu",value:function(t){for(var e=this.leakyReluAlpha,n=this.outputLayer;n>=0;n--)for(var r=this.sizes[n],i=this.outputs[n],o=this.deltas[n+1],a=this.weights[n+1],u=this.errors[n],s=this.deltas[n],c=0;c<r;c++){var l=i[c],h=0;if(n===this.outputLayer)h=t[c]-l;else for(var p=0;p<o.length;p++)h+=o[p]*a[p][c];u[c]=h,s[c]=l>0?h:e*h}}},{key:"_calculateDeltasTanh",value:function(t){for(var e=this.outputLayer;e>=0;e--)for(var n=this.sizes[e],r=this.outputs[e],i=this.deltas[e+1],o=this.weights[e+1],a=this.errors[e],u=this.deltas[e],s=0;s<n;s++){var c=r[s],l=0;if(e===this.outputLayer)l=t[s]-c;else for(var h=0;h<i.length;h++)l+=i[h]*o[h][s];a[s]=l,u[s]=(1-c*c)*l}}},{key:"adjustWeights",value:function(){for(var t=this.trainOpts,e=t.learningRate,n=t.momentum,r=1;r<=this.outputLayer;r++)for(var i=this.outputs[r-1],o=this.sizes[r],a=this.deltas[r],u=this.changes[r],s=this.weights[r],c=this.biases[r],l=0;l<o;l++){for(var h=a[l],p=0;p<i.length;p++){var f=u[l][p];f=e*h*i[p]+n*f,u[l][p]=f,s[l][p]+=f}c[l]+=e*h}}},{key:"_setupAdam",value:function(){this.biasChangesLow=[],this.biasChangesHigh=[],this.changesLow=[],this.changesHigh=[],this.iterations=0;for(var t=0;t<=this.outputLayer;t++){var e=this.sizes[t];if(t>0){this.biasChangesLow[t]=di(e),this.biasChangesHigh[t]=di(e),this.changesLow[t]=new Array(e),this.changesHigh[t]=new Array(e);for(var n=0;n<e;n++){var r=this.sizes[t-1];this.changesLow[t][n]=di(r),this.changesHigh[t][n]=di(r)}}}this.adjustWeights=this._adjustWeightsAdam}},{key:"_adjustWeightsAdam",value:function(){this.iterations++;for(var t=this.iterations,e=this.trainOpts,n=e.beta1,r=e.beta2,i=e.epsilon,o=e.learningRate,a=1;a<=this.outputLayer;a++)for(var u=this.outputs[a-1],s=this.sizes[a],c=this.deltas[a],l=this.changesLow[a],h=this.changesHigh[a],p=this.weights[a],f=this.biases[a],y=this.biasChangesLow[a],d=this.biasChangesHigh[a],g=0;g<s;g++){for(var v=c[g],m=0;m<u.length;m++){var b=v*u[m],w=l[g][m]*n+(1-n)*b,k=h[g][m]*r+(1-r)*b*b,O=w/(1-Math.pow(n,t)),L=k/(1-Math.pow(r,t));l[g][m]=w,h[g][m]=k,p[g][m]+=o*O/(Math.sqrt(L)+i)}var A=c[g],T=y[g]*n+(1-n)*A,_=d[g]*r+(1-r)*A*A,x=y[g]/(1-Math.pow(n,t)),E=d[g]/(1-Math.pow(r,t));y[g]=T,d[g]=_,f[g]+=o*x/(Math.sqrt(E)+i)}}},{key:"formatData",value:function(t){if(Array.isArray(t)||(t=[t]),!Array.isArray(t[0].input))if(this.inputLookup)this.inputLookupLength=Object.keys(this.inputLookup).length;else{var e=new lookupTable(t,"input");this.inputLookup=e.table,this.inputLookupLength=e.length}if(!Array.isArray(t[0].output))if(this.outputLookup)this.outputLookupLength=Object.keys(this.outputLookup).length;else{var n=new lookupTable(t,"output");this.outputLookup=n.table,this.outputLookupLength=n.length}if(void 0===this._formatInput&&(this._formatInput=getTypedArrayFn(t[0].input,this.inputLookup),this._formatOutput=getTypedArrayFn(t[0].output,this.outputLookup)),this._formatInput&&this._formatOutput){for(var r=[],i=0;i<t.length;i++)r.push({input:this._formatInput(t[i].input),output:this._formatOutput(t[i].output)});return r}if(this._formatInput){for(var o=[],a=0;a<t.length;a++)o.push({input:this._formatInput(t[a].input),output:t[a].output});return o}if(this._formatOutput){for(var u=[],s=0;s<t.length;s++)u.push({input:t[s].input,output:this._formatOutput(t[s].output)});return u}return t}},{key:"addFormat",value:function(t){this.inputLookup=vi.addKeys(t.input,this.inputLookup),this.inputLookup&&(this.inputLookupLength=Object.keys(this.inputLookup).length),this.outputLookup=vi.addKeys(t.output,this.outputLookup),this.outputLookup&&(this.outputLookupLength=Object.keys(this.outputLookup).length)}},{key:"test",value:function(t){var e=this,n=1===(t=this.formatData(t))[0].output.length,r=[],i=0;if(n){for(var o=0,a=0,u=0,s=0,c=function(n){var c=e.runInput(t[n].input),l=t[n].output,h=c[0]>e.binaryThresh?1:0,p=l[0];if(h!==p){var f=t[n];r.push({input:f.input,output:f.output,actual:h,expected:p})}0===h&&0===p?s++:1===h&&1===p?u++:0===h&&1===p?a++:1===h&&0===p&&o++,i+=mse(c.map(function(t,e){return l[e]-t}))},l=0;l<t.length;l++)c(l);return{error:i/t.length,misclasses:r,total:t.length,trueNeg:s,truePos:u,falseNeg:a,falsePos:o,precision:u>0?u/(u+o):0,recall:u>0?u/(u+a):0,accuracy:(s+u)/t.length}}for(var h=function(n){var o=e.runInput(t[n].input),a=t[n].output,u=o.indexOf(max$3(o)),s=a.indexOf(max$3(a));if(u!==s){var c=t[n];r.push({input:c.input,output:c.output,actual:u,expected:s})}i+=mse(o.map(function(t,e){return a[e]-t}))},p=0;p<t.length;p++)h(p);return{error:i/t.length,misclasses:r,total:t.length}}},{key:"toJSON",value:function(){null===this.sizes&&this.initialize();for(var t=[],e=0;e<=this.outputLayer;e++){t[e]={};var n=void 0;n=0===e&&this.inputLookup?Object.keys(this.inputLookup):this.outputLookup&&e===this.outputLayer?Object.keys(this.outputLookup):Hi(0,this.sizes[e]);for(var r=0;r<n.length;r++){var i=n[r];if(t[e][i]={},e>0)for(var o in t[e][i].bias=this.biases[e][r],t[e][i].weights={},t[e-1]){var a=o;1===e&&this.inputLookup&&(a=this.inputLookup[o]),t[e][i].weights[o]=this.weights[e][r][a]}}}return{sizes:this.sizes.slice(0),layers:t,outputLookup:null!==this.outputLookup,inputLookup:null!==this.inputLookup,activation:this.activation,trainOpts:this.getTrainOptsJSON()}}},{key:"fromJSON",value:function(t){Object.assign(this,this.constructor.defaults,t),this.sizes=t.sizes,this.initialize();for(var e=0;e<=this.outputLayer;e++){var n=t.layers[e];if(0!==e||n[0]&&!t.inputLookup?e!==this.outputLayer||n[0]&&!t.outputLookup||(this.outputLookup=vi.toHash(n)):(this.inputLookup=vi.toHash(n),this.inputLookupLength=Object.keys(this.inputLookup).length),e>0){var r=Object.keys(n);for(var i in this.sizes[e]=r.length,r)if(r.hasOwnProperty(i)){var o=r[i];this.biases[e][i]=n[o].bias,this.weights[e][i]=(a=n[o].weights,Array.isArray(a)?a:new Float32Array(Object.values(a)))}}}var a;return t.hasOwnProperty("trainOpts")&&this.updateTrainingOptions(t.trainOpts),this}},{key:"toFunction",value:function(t){var e=this.activation,n=this.leakyReluAlpha,r=!1;function i(t,o,a){if(0===o)return"string"==typeof a?"(input['".concat(a,"']||0)"):"(input[".concat(a,"]||0)");var u=t[o][a],s=["(",u.bias];for(var c in u.weights)u.weights[c]<0?s.push("".concat(u.weights[c],"*").concat(i(t,o-1,c))):s.push("+".concat(u.weights[c],"*").concat(i(t,o-1,c)));switch(s.push(")"),e){case"sigmoid":return"1/(1+1/Math.exp(".concat(s.join(""),"))");case"relu":return r=!0,"((v=".concat(s.join(""),")<0?0:v)");case"leaky-relu":return r=!0,"((v=".concat(s.join(""),")<0?0:").concat(n,"*v)");case"tanh":return"Math.tanh(".concat(s.join(""),")");default:throw new Error("Unknown activation ".concat(this.activation,". Available activations are: 'sigmoid', 'relu', 'leaky-relu', 'tanh'"))}}var o,a=this.toJSON().layers,u=[];for(var s in a[a.length-1])u.push(i(a,a.length-1,s));o=this.outputLookup?"{".concat(Object.keys(this.outputLookup).map(function(t,e){return"'".concat(t,"':").concat(u[e])}),"}"):"[".concat(u.join(","),"]");var c="".concat(r?"var v;":"","return ").concat(o,";");return new Function("input",t?t(c):c)}},{key:"isRunnable",get:function(){var t=this;if(!this.runInput)return console.error("Activation function has not been initialized, did you run train()?"),!1;var e=["sizes","outputLayer","biases","weights","outputs","deltas","changes","errors"].filter(function(e){return null===t[e]});return!(e.length>0)||(console.error("Some settings have not been initialized correctly, did you run train()? Found issues with: ".concat(e.join(", "))),!1)}}]),t}();return n(function(t){var e={FeedForward:mi.FeedForward,NeuralNetwork:Wi};"undefined"!=typeof window&&(window.brain=e),t.exports=e})}),PointNG.prototype=function(t){var e,n,r,i,o="https://cdn.pointng.io/networks/",a=["Unknown error","Permission denied by user","Position is not available","Request timed out"],u={continent:null,sub_region:null,country:null,country_id:0,capital:null,currency:null,phone_code:null,iso2:null,iso3:null,state:null,state_id:null,state_code:null,city:null,city_id:null,latitude:0,longitude:0,ready:null},s="pointng_script";async function c(n,r,i,o,a,u,s,l){if(l&&(e=l),el=t.getElementById(i),el){el.remove();const e=t.createElement("script");e.src=o,e.id=i,t.body.appendChild(e),e.onload=async function(){s&&await s(n,r,a,u,c)}}else{const e=t.createElement("script");e.src=o,e.id=i,t.body.appendChild(e),e.onload=async function(){s&&await s(n,r,a,u,c)}}}function l(r,i,a,c,l){var p=netJsonSub.sub_region,f=new brain.NeuralNetwork;f.fromJSON(p),f.toFunction();var g=d(f.run(y(r,i,5)));u.continent=g.split("&")[0],u.sub_region=g.split("&")[1].replace(/_/g," "),console.log(e),"continent"!=e&&e&&null!=e&&null!=e&&0!=e&&""!=e?"country"==e||"state"==e||"city"==e?l(r,i,s,o+"iso2/"+decodeURIComponent(u.sub_region).replace(/ /g,"_").toLowerCase()+"_iso2.js?api_key="+n,a,c,h):c(new Error("Unable to return location information due to invalid level-configuration.")):(t.getElementById("pointng-loader").style.opacity=0,t.getElementById("pointng-loader").style["z-index"]=-1,u.ready=!0,a(u))}function h(r,i,a,c,l){if(netJson){var h=netJson[`${u.sub_region.replace(/ /g,"_").toLowerCase()+"_iso2"}`],f=new brain.NeuralNetwork;f.fromJSON(h),f.toFunction();var g=d(f.run(y(r,i,5)));u.country=g.split("&")[0].replace(/_/g," "),u.iso2=g.split("&")[1],u.iso3=g.split("&")[2],u.phone_code=g.split("&")[3],u.capital=g.split("&")[4],u.currency=g.split("&")[5],"country"==e?(u.ready=!0,t.getElementById("pointng-loader").style.opacity=0,t.getElementById("pointng-loader").style["z-index"]=-1,a(u)):"state"==e||"city"==e?l(r,i,s,o+"state/"+decodeURIComponent(u.iso2).replace(/ /g,"_").toLowerCase()+"_state.js?api_key="+n,a,c,p):c(new Error("Unable to return location information due to invalid level-configuration."))}else c(new Error("Unable to return location information. Make sure you provided a valid API key."))}function p(r,i,a,c,l){var h=netJson[`${u.iso2.replace(/ /g,"_").toLowerCase()+"_state"}`],p=new brain.NeuralNetwork;p.fromJSON(h),p.toFunction();var g=d(p.run(y(r,i,5)));u.state=g.split("&")[0].replace(/_/g," "),"state"==e?(u.ready=!0,t.getElementById("pointng-loader").style.opacity=0,t.getElementById("pointng-loader").style["z-index"]=-1,a(u)):l(r,i,s,o+"city/"+u.iso2.toLowerCase()+"_"+decodeURIComponent(u.state).replace(/ /g,"_").toLowerCase()+"_city.js?api_key="+n,a,c,f)}function f(e,n,r,i){var o=netJson[`${u.iso2.toLowerCase()+"_"+u.state.replace(/ /g,"_").toLowerCase()+"_city"}`],a=new brain.NeuralNetwork;a.fromJSON(o),a.toFunction();var s=d(a.run(y(e,n,5)));u.city=s.split("&")[0].replace(/_/g," "),u.latitude=parseFloat(s.split("&")[1]),u.longitude=parseFloat(s.split("&")[2]),u.sub_region&&u&&u.city?(u.ready=!0,t.getElementById("pointng-loader").style.opacity=0,t.getElementById("pointng-loader").style["z-index"]=-1,r(u)):i(new Error("Unable to return location information"))}function y(t,e,n){var r={},i=function(t,e,n){for(var r="0123456789bcdefghjkmnpqrstuvwxyz",i={},o=0;o<r.length;o++)i[r.charAt(o)]=o;if("auto"===n){if("number"==typeof t||"number"==typeof e)throw new Error("string notation required for auto precision.");var a=t.split(".")[1].length,u=e.split(".")[1].length,s=Math.max(a,u);n=[0,5,7,8,11,12,13,15,16,17,18][s]}else void 0===n&&(n=10);var c,l=[],h=0,p=0,f=0,y=90,d=-90,g=180,v=-180;for(;l.length<n;)if(p%2==0?e>(c=(g+v)/2)?(f=1+(f<<1),v=c):(f=0+(f<<1),g=c):t>(c=(y+d)/2)?(f=1+(f<<1),d=c):(f=0+(f<<1),y=c),p++,5===++h){var m=r[f];l.push(m),h=0,f=0}return l.join("")}(t,e,n),o=i.charAt(0),a=i.charAt(1),u=i.charAt(2),s=i.charAt(3),c=i.charAt(4),l=i.charAt(5);return r[`${"first_".concat(o)}`]=1,r[`${"second_".concat(a)}`]=1,r[`${"third_".concat(u)}`]=1,r[`${"fourth_".concat(s)}`]=1,r[`${"fifth_".concat(c)}`]=1,r[`${"sixth_".concat(l)}`]=1,r}function d(t){var e=[];for(var n in t)e.push([n,t[n]]);return e.sort(function(t,e){return e[1]-t[1]}),e[0][0]}function g(e,n,r,i){var o=t.querySelector(e),a=t.createElement(n);a.innerHTML=i,"head"!=e&&(a.className+=r),o.appendChild(a)}return{getLocation:function(t){e=t||this.config.level,n=this.config.api_key;var r=new Promise(function(t,e){navigator.geolocation.getCurrentPosition(async function(e){var r=await async function(t,e){return new Promise(function(r,i){c(t,e,s,o+"sub_region.js?api_key="+n,r,i,l)})}(e.coords.latitude,e.coords.longitude);t(r)},function(e){a[e.code],0!==e.code&&2!==e.code||e.message,t(u)})});return r.catch(t=>u),r},latLonLocate:function(t,r){return e=this.config.level,n=this.config.api_key,new Promise(function(e,i){c(t,r,s,o+"sub_region.js?api_key="+n,e,i,l)})},predictionData:u,userLocate:function(){t.getElementById("pointngForm").style.display="none",t.getElementById("pointng-loader").style.opacity=1,t.getElementById("pointng-loader").style["z-index"]=1,u.ready=!1;var e=t.getElementsByName("levels");if(!(t.getElementById("pointng-continent").checked||t.getElementById("pointng-country").checked||t.getElementById("pointng-state").checked||t.getElementById("pointng-city").checked))return console.log("not checked"),void(t.getElementById("warning").innerHTML="<p>Select at least one</p>");for(var n=0,r=e.length;n<r;n++)if(e[n].checked){console.log(e[n].value),this.getLocation(e[n].value);break}},openWidget:function(e){return new Promise(function(n,r){"loading"!=t.readyState?e():t.addEventListener("DOMContentLoaded",e),n("success")})},start:function(){console.log(this.config.widgetPosition),r="left"==this.config.widgetPosition?"left":"right",i=this.config.privacyPolicyLink,g("head","style","",`.pointng-open-button{color:#fff;border-radius: 5px;box-shadow: 0 2px 6px 0 rgba(0,0,0,.4);margin: 20px;border:none;cursor:pointer;position:fixed;bottom:5px;${r}:5px;width:35px}\n    .pointng-header{\n        padding: 0px;\n        display: block;\n        font-size: 1.17em;\n        margin-block-start: 1em;\n        margin-block-end: 1em;\n        margin-inline-start: 0px;\n        margin-inline-end: 0px;\n        font-weight: bold;\n    }\n        .pointng-popup{\n            display:none;\n            position:fixed;\n            bottom:0;\n            margin-bottom: 70px;\n            margin-right: 10px;\n            ${r}:15px;\n            border:2px solid #f1f1f1;\n            z-index:9;\n            border-radius: 5px;\n            font-family: system-ui;\n        }\n        .pointng-form-container{max-width:300px;padding-left:20px;padding-right:20px;padding-bottom:20px;padding-top:20px;background-color:#fff}.pointng-form-container textarea{width:100%;padding:15px;margin:5px 0 22px 0;border:none;background:#f1f1f1;resize:none;min-height:200px}.pointng-form-container textarea:focus{background-color:#ddd;outline:0}\n        .pointng-form-container .btn{\n            background-color:#31b0d4 !important;border-radius:5px;font-size:1.1em;color:#fff;padding:16px 20px;border:none;cursor:pointer;width:100%;margin-bottom:10px;opacity:.8}.pointng-form-container .cancel{background-color:red}.form-container .btn:hover,.pointng-open-button:hover{opacity:1}.pointng-link {text-decoration: none;}\n            \n            .pointng-loader-wrapper {\n                position: fixed;\n                bottom: 0;\n                ${r}: 0;\n                padding: 10px;\n                background: #fff;\n                margin-bottom: 25px;\n                margin-${r}: 25px;\n                opacity: 1;\n                z-index: 1;\n                transition: opacity .3s;\n                display: flex;\n                align-items: center;\n                border-radius: 6px;\n                height: 15px;\n                width: 15px;\n              } \n\n              .ring-container {\n                position: fixed;\n                bottom: 0;\n                ${r}: 0;\n                padding: 10px;\n                background: #fff;\n                margin-bottom: 25px;\n                margin-${r}: 25px;\n                opacity: 0;\n                z-index: -1;\n                transition: opacity .3s;\n                display: flex;\n                align-items: center;\n                border-radius: 6px;\n                height: 35px;\n                width: 35px;\n            }\n            \n            .circle {\n                width: 15px;\n                height: 15px;\n                background-color: #dddde8;\n                border-radius: 50%;\n                position: fixed;\n                ${r}: 0;\n                bottom: 0;\n                margin-${r}: 35px;\n                margin-bottom: 35px;\n            }\n            \n            .ringring {\n                border: 3px solid #dddde8;\n                -webkit-border-radius: 30px;\n                height: 25px;\n                width: 25px;\n                position: fixed;\n                ${r}: 0;\n                bottom: 0;\n                margin-${r}: 30px;\n                margin-bottom: 30px;\n                -webkit-animation: pulsate 1s ease-out;\n                -webkit-animation-iteration-count: infinite;\n                opacity: 0.0;\n            }\n            @-webkit-keyframes pulsate {\n                0% {-webkit-transform: scale(0.1, 0.1); opacity: 0.0;}\n                50% {opacity: 1.0;}\n                100% {-webkit-transform: scale(1.2, 1.2); opacity: 0.0;}\n            }\n            \n            `),t.body.innerHTML+='<div class="pointng-widget"></div>',t.body.innerHTML+='<div id="pointng-loader" class="ring-container"><div class="ringring"></div><div class="circle"></div></div>';for(var e=t.querySelectorAll(".pointng-widget"),n=0;n<e.length;n++)e[n].setAttribute("id","pointng-widget"+n),g("#pointng-widget"+n,"div","",`<img class="pointng-open-button" src="https://cdn.pointng.io/pointng_widget.svg" alt="pointng" onclick="pointng.openForm()"><div class="pointng-popup" id="pointngForm"><form onsubmit="return false;" style="margin-bottom: 0px;"><div class="pointng-form-container"> <span class="pointng-header">pointNG location management</span><p>Choose the level that you allow this website to use your location.</p><input type="radio" id="pointng-continent" name="levels" value="continent" checked> <label for="continent">Continent</label><br><input type="radio" id="pointng-country" name="levels" value="country"> <label for="country">Country</label><br><input type="radio" id="pointng-state" name="levels" value="state"><label for="state"> State</label><br><input type="radio" id="pointng-city" name="levels" value="city"><label for="city"> City</label><br><div id="warning"></div><br><button type="submit" id="locateMe" class="btn" onclick="pointng.userLocate()">Locate me</button><button type="submit" id="locateMe" class="btn" onclick="pointng.savePreferences()">Save my preferences</button><br><a class="pointng-link" href="${i}">Read how this site uses your location &raquo;</a></div></form></div>`)},openForm:function(){"block"==t.getElementById("pointngForm").style.display?t.getElementById("pointngForm").style.display="none":t.getElementById("pointngForm").style.display="block"},savePreferences:function(){t.getElementById("pointngForm").style.display="none",u.ready=!1;var n=t.getElementsByName("levels");if(!(t.getElementById("pointng-continent").checked||t.getElementById("pointng-country").checked||t.getElementById("pointng-state").checked||t.getElementById("pointng-city").checked))return console.log("not checked"),void(t.getElementById("warning").innerHTML="<p>Select at least one</p>");for(var r=0,i=n.length;r<i;r++)if(n[r].checked){console.log(n[r].value),this.currentLevel=n[r].value,this.config.level=n[r].value,e=n[r].value;break}}}}(document);